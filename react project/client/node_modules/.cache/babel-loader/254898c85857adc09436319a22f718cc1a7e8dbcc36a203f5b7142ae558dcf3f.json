{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './1.docx';\nconst generateDocument = ({\n  studentData,\n  teacherData,\n  requestData,\n  action\n}) => {\n  if (action === 'approve') {\n    action = 'утвердить';\n  } else if (actionParam === 'change') {\n    action = 'изменить';\n  } else {\n    // В случае, если параметр action не равен 'approve' или 'change'\n    action = 'действие не определено';\n  }\n  console.log(action);\n  const fullname = studentData.surname + ' ' + studentData.name + ' ' + studentData.patronymic;\n  const np_s = studentData.name.charAt(0) + '.' + studentData.patronymic.charAt(0) + '. ';\n  const np_t = teacherData.name.charAt(0) + '.' + teacherData.patronymic.charAt(0) + '. ';\n  var surname_gen = petrovich.female.last.genitive(studentData.surname);\n  var teacher = {\n    last: teacherData.surname,\n    first: teacherData.name,\n    middle: teacherData.patronymic\n  };\n  var fullnameTeac = petrovich(teacher, 'accusative');\n  fullnameTeac = fullnameTeac.last + ' ' + fullnameTeac.first + ' ' + fullnameTeac.middle;\n  const rne = new RussianNouns.Engine();\n  let form_of_studying = studentData.form_of_studying;\n  let academic_title = teacherData.academic_title;\n  let academic_degree = teacherData.academic_degree;\n  let job_title = teacherData.job_title;\n  let place_of_work = teacherData.place_of_work;\n  const firstWordForm = form_of_studying.split(\" \")[0];\n  const firstWordTitle = academic_title.split(\" \")[0];\n  const firstWordDegree = academic_degree.split(\" \")[0];\n  const firstWordJobTitle = job_title.split(\" \")[0];\n  const firstWordPlace = place_of_work.split(\" \")[0];\n  const declinedForm = rne.decline({\n    text: firstWordForm,\n    gender: 'женский'\n  }, 'родительный');\n  const declinedTitle = rne.decline({\n    text: firstWordTitle,\n    gender: 'средний'\n  }, 'родительный');\n  const declinedDegree = rne.decline({\n    text: firstWordDegree,\n    gender: 'средний'\n  }, 'родительный');\n  const declinedJobTitle = rne.decline({\n    text: firstWordJobTitle,\n    gender: 'средний'\n  }, 'родительный');\n  const declinedPlace = rne.decline({\n    text: firstWordPlace,\n    gender: 'женский'\n  }, 'родительный');\n  form_of_studying = form_of_studying.replace(firstWordForm, declinedForm);\n  academic_title = academic_title.replace(firstWordTitle, declinedTitle);\n  academic_degree = academic_degree.replace(firstWordDegree, declinedDegree);\n  job_title = job_title.replace(firstWordJobTitle, declinedJobTitle);\n  place_of_work = place_of_work.replace(firstWordPlace, declinedPlace);\n  const xhr = new XMLHttpRequest();\n  xhr.open('GET', word, true);\n  xhr.responseType = 'arraybuffer';\n  xhr.onload = () => {\n    if (xhr.status === 200) {\n      const data = new Uint8Array(xhr.response);\n      const zip = new PizZip(data);\n      let doc;\n      try {\n        doc = new Docxtemplater(zip);\n      } catch (error) {\n        console.error('Ошибка создания документа:', error);\n        return;\n      }\n      const dataToRender = {\n        np_s: np_s,\n        np_t: np_t,\n        surname: studentData.surname,\n        surname_gen: surname_gen,\n        phoneNumber: studentData.phone_number,\n        email: studentData.email,\n        kurs: studentData.kurs,\n        group: studentData.group,\n        specialtyCode: studentData.specialtyCode,\n        specialtyName: studentData.specialtyName,\n        fieldOfStudyCode: studentData.fieldOfStudyCode,\n        fieldOfStudyName: studentData.fieldOfStudyName,\n        form_of_studying: form_of_studying,\n        base_of_studying: studentData.basis_of_study,\n        fullname: fullname,\n        theme_str: requestData.theme_str,\n        fullnameTeacher: fullnameTeac,\n        surnameTeacher: teacherData.surname,\n        academic_degree: academic_degree,\n        academic_title: academic_title,\n        job_title: job_title,\n        place_of_work: place_of_work\n      };\n      doc.setData(dataToRender);\n      try {\n        doc.render();\n      } catch (error) {\n        console.error('Ошибка рендеринга документа:', error);\n        return;\n      }\n      const output = doc.getZip().generate({\n        type: 'blob'\n      });\n      saveAs(output, 'generated_document.docx');\n    } else {\n      console.error('Ошибка загрузки файла:', xhr.statusText);\n    }\n  };\n  xhr.onerror = () => {\n    console.error('Ошибка загрузки файла:', xhr.statusText);\n  };\n  xhr.send();\n};\nexport default generateDocument;\nfunction extractVariables(template) {\n  var re = /({.*?})/sg;\n  let variables = [];\n  let result;\n  while ((result = re.exec(template)) !== null) {\n    variables.push(result[0]);\n  }\n  return variables;\n}","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateDocument","studentData","teacherData","requestData","action","actionParam","console","log","fullname","surname","name","patronymic","np_s","charAt","np_t","surname_gen","female","last","genitive","teacher","first","middle","fullnameTeac","rne","Engine","form_of_studying","academic_title","academic_degree","job_title","place_of_work","firstWordForm","split","firstWordTitle","firstWordDegree","firstWordJobTitle","firstWordPlace","declinedForm","decline","text","gender","declinedTitle","declinedDegree","declinedJobTitle","declinedPlace","replace","xhr","XMLHttpRequest","open","responseType","onload","status","data","Uint8Array","response","zip","doc","error","dataToRender","phoneNumber","phone_number","email","kurs","group","specialtyCode","specialtyName","fieldOfStudyCode","fieldOfStudyName","base_of_studying","basis_of_study","theme_str","fullnameTeacher","surnameTeacher","setData","render","output","getZip","generate","type","statusText","onerror","send","extractVariables","template","re","variables","result","exec","push"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/react project/client/src/components/Forms/GenerateApplicationForm/GenerateDocumentFunction.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './1.docx';\r\n\r\n\r\nconst generateDocument = ({studentData, teacherData, requestData, action}) => {\r\n\r\n    if (action === 'approve') {\r\n      action = 'утвердить';\r\n    } else if (actionParam === 'change') {\r\n      action = 'изменить';\r\n    } else {\r\n      // В случае, если параметр action не равен 'approve' или 'change'\r\n      action = 'действие не определено';\r\n    }\r\n\r\n    console.log(action);\r\n\r\n    const fullname = studentData.surname + ' ' + studentData.name + ' ' + studentData.patronymic\r\n    const np_s = studentData.name.charAt(0) + '.'+ studentData.patronymic.charAt(0) + '. ';\r\n    const np_t = teacherData.name.charAt(0) + '.' + teacherData.patronymic.charAt(0) + '. ';\r\n\r\n    var surname_gen = petrovich.female.last.genitive (studentData.surname);\r\n    var teacher = {\r\n    last: teacherData.surname,\r\n    first: teacherData.name,\r\n    middle: teacherData.patronymic\r\n    };\r\n\r\n    var fullnameTeac = petrovich(teacher, 'accusative');\r\n    fullnameTeac = fullnameTeac.last + ' ' + fullnameTeac.first + ' '+ fullnameTeac.middle\r\n\r\n    const rne = new RussianNouns.Engine();\r\n    \r\n    let form_of_studying = studentData.form_of_studying;\r\n    let academic_title = teacherData.academic_title;\r\n    let academic_degree = teacherData.academic_degree;\r\n    let job_title = teacherData.job_title;\r\n    let place_of_work = teacherData.place_of_work;\r\n\r\n    const firstWordForm = form_of_studying.split(\" \")[0];\r\n    const firstWordTitle = academic_title.split(\" \")[0];\r\n    const firstWordDegree = academic_degree.split(\" \")[0];\r\n    const firstWordJobTitle = job_title.split(\" \")[0];\r\n    const firstWordPlace = place_of_work.split(\" \")[0];\r\n    const declinedForm= rne.decline({text: firstWordForm, gender: 'женский'}, 'родительный');\r\n    const declinedTitle = rne.decline({text: firstWordTitle, gender: 'средний'}, 'родительный');\r\n    const declinedDegree = rne.decline({text: firstWordDegree, gender: 'средний'}, 'родительный');\r\n    const declinedJobTitle = rne.decline({text: firstWordJobTitle, gender: 'средний'}, 'родительный');\r\n    const declinedPlace = rne.decline({text: firstWordPlace, gender: 'женский'}, 'родительный');\r\n\r\n    form_of_studying = form_of_studying.replace(firstWordForm, declinedForm);\r\n    academic_title = academic_title.replace(firstWordTitle, declinedTitle);\r\n    academic_degree = academic_degree.replace(firstWordDegree, declinedDegree);\r\n    job_title = job_title.replace(firstWordJobTitle, declinedJobTitle);\r\n    place_of_work = place_of_work.replace(firstWordPlace, declinedPlace);\r\n    \r\n\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', word, true);\r\n    xhr.responseType = 'arraybuffer';\r\n\r\n\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) {\r\n        const data = new Uint8Array(xhr.response);\r\n        const zip = new PizZip(data);\r\n        let doc;\r\n        try {\r\n          doc = new Docxtemplater(zip);\r\n        } catch (error) {\r\n          console.error('Ошибка создания документа:', error);\r\n          return;\r\n        }\r\n\r\n\r\n        const dataToRender = {\r\n          np_s: np_s,\r\n          np_t: np_t,\r\n          surname: studentData.surname,\r\n          surname_gen: surname_gen,\r\n          phoneNumber: studentData.phone_number,\r\n          email: studentData.email,\r\n          kurs: studentData.kurs,\r\n          group: studentData.group,\r\n          specialtyCode: studentData.specialtyCode,\r\n          specialtyName: studentData.specialtyName,\r\n          fieldOfStudyCode: studentData.fieldOfStudyCode,\r\n          fieldOfStudyName: studentData.fieldOfStudyName,\r\n          form_of_studying: form_of_studying,\r\n          base_of_studying: studentData.basis_of_study,\r\n          fullname: fullname,\r\n          theme_str: requestData.theme_str,\r\n          fullnameTeacher:fullnameTeac,\r\n          surnameTeacher: teacherData.surname,\r\n          academic_degree: academic_degree,\r\n          academic_title: academic_title,\r\n          job_title: job_title,\r\n          place_of_work: place_of_work,\r\n        };\r\n\r\n        doc.setData(dataToRender);\r\n\r\n        try {\r\n          doc.render();\r\n        } catch (error) {\r\n          console.error('Ошибка рендеринга документа:', error);\r\n          return;\r\n        }\r\n\r\n        const output = doc.getZip().generate({ type: 'blob' });\r\n        saveAs(output, 'generated_document.docx');\r\n      } else {\r\n        console.error('Ошибка загрузки файла:', xhr.statusText);\r\n      }\r\n    };\r\n\r\n    xhr.onerror = () => {\r\n      console.error('Ошибка загрузки файла:', xhr.statusText);\r\n    };\r\n\r\n    xhr.send();\r\n  };\r\n\r\nexport default generateDocument\r\n\r\nfunction extractVariables(template) {\r\n    var re = /({.*?})/sg;\r\n    let variables = [];\r\n    let result;\r\n    while ((result = re.exec(template)) !== null) {\r\n        variables.push(result[0]); \r\n    }\r\n    return variables;\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}