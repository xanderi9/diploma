{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './protocol.docx';\nconst generateProtocolsFunction = async ({\n  composition_of_sec,\n  selectedGroups,\n  dateStart,\n  audienceNumber,\n  protocol_number,\n  hours_start,\n  min_start,\n  hours_end,\n  min_end,\n  student_fullname,\n  specialityCode,\n  specialtityProgram,\n  theme,\n  teacher_first_name,\n  teacher_np,\n  teacher_degree,\n  teacher_job_title,\n  reviewer_first_name,\n  reviewer_np,\n  reviewer_degree,\n  reviewer_job_title,\n  student_first_name,\n  student_np,\n  duration\n}) => {\n  const chairman = composition_of_sec.find(comp => comp.chairman_of_SEC === true);\n  const members_list = composition_of_sec.filter(sec => sec.chairman_of_SEC === false);\n  const getInitials = (firstName, patronymic) => {\n    return `${firstName.charAt(0)}.${patronymic.charAt(0)}.`;\n  };\n  const np = getInitials(chairman.user.first_name, chairman.user.patronymic);\n  try {\n    const response = await fetch(word);\n    if (!response.ok) throw new Error('Ошибка сети');\n    const arrayBuffer = await response.arrayBuffer();\n    const zip = new PizZip(arrayBuffer);\n    const doc = new Docxtemplater(zip);\n    const dataToRender = {\n      protocol_number: protocol_number,\n      group_protection_date: new Date(dateStart).toLocaleDateString('ru-RU'),\n      hours_start: hours_start,\n      min_start: min_start,\n      hours_end: hours_end,\n      min_end: min_end,\n      chairman_last_name: chairman.user.last_name,\n      chairman_np: np,\n      chairman_degree: chairman.employee_information.academic_degree,\n      chairman_job_title: chairman.employee_information.job_title,\n      members_list: members_list.map(member => ({\n        members_last_name: member.user.last_name,\n        members_np: getInitials(member.user.first_name, member.user.patronymic),\n        members_degree: member.employee_information.academic_degree || '',\n        members_job_title: member.employee_information.job_title,\n        members_place_of_work: member.employee_information.place_of_work\n      })),\n      student_fullname: student_fullname,\n      specialityCode: specialityCode,\n      specialtityProgram: specialtityProgram,\n      theme: theme,\n      teacher_first_name: teacher_first_name,\n      teacher_np: teacher_np,\n      teacher_degree: teacher_degree,\n      teacher_job_title: teacher_job_title,\n      reviewer_first_name: reviewer_first_name,\n      reviewer_np: reviewer_np,\n      reviewer_degree: reviewer_degree,\n      reviewer_job_title: reviewer_job_title,\n      student_first_name: student_first_name,\n      student_np: student_np,\n      duration: duration\n    };\n    doc.setData(dataToRender);\n    doc.render();\n    const output = doc.getZip().generate({\n      type: 'blob'\n    });\n    saveAs(output, `Протокол №${protocol_number}.docx`);\n  } catch (error) {\n    console.error('Ошибка загрузки файла:', error);\n  }\n};\nexport default generateProtocolsFunction;","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateProtocolsFunction","composition_of_sec","selectedGroups","dateStart","audienceNumber","protocol_number","hours_start","min_start","hours_end","min_end","student_fullname","specialityCode","specialtityProgram","theme","teacher_first_name","teacher_np","teacher_degree","teacher_job_title","reviewer_first_name","reviewer_np","reviewer_degree","reviewer_job_title","student_first_name","student_np","duration","chairman","find","comp","chairman_of_SEC","members_list","filter","sec","getInitials","firstName","patronymic","charAt","np","user","first_name","response","fetch","ok","Error","arrayBuffer","zip","doc","dataToRender","group_protection_date","Date","toLocaleDateString","chairman_last_name","last_name","chairman_np","chairman_degree","employee_information","academic_degree","chairman_job_title","job_title","map","member","members_last_name","members_np","members_degree","members_job_title","members_place_of_work","place_of_work","setData","render","output","getZip","generate","type","error","console"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/хлам/react project/client/src/components/Forms/GenerateProtocols/GenerateProtocolFunction.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './protocol.docx';\r\n\r\nconst generateProtocolsFunction = async ({ \r\n    composition_of_sec, \r\n    selectedGroups, \r\n    dateStart, \r\n    audienceNumber,\r\n    protocol_number,\r\n    hours_start,\r\n    min_start,\r\n    hours_end,\r\n    min_end,\r\n    student_fullname,\r\n    specialityCode,\r\n    specialtityProgram,\r\n    theme,\r\n    teacher_first_name,\r\n    teacher_np,\r\n    teacher_degree,\r\n    teacher_job_title,\r\n    reviewer_first_name,\r\n    reviewer_np,\r\n    reviewer_degree,\r\n    reviewer_job_title,\r\n    student_first_name,\r\n    student_np,\r\n    duration\r\n}) => {\r\n    const chairman = composition_of_sec.find(comp => comp.chairman_of_SEC === true);\r\n    const members_list = composition_of_sec.filter(sec => sec.chairman_of_SEC === false);\r\n    \r\n    const getInitials = (firstName, patronymic) => {\r\n        return `${firstName.charAt(0)}.${patronymic.charAt(0)}.`;\r\n    };\r\n\r\n    const np = getInitials(chairman.user.first_name, chairman.user.patronymic);\r\n\r\n    try {\r\n        const response = await fetch(word);\r\n        if (!response.ok) throw new Error('Ошибка сети');\r\n        const arrayBuffer = await response.arrayBuffer();\r\n        const zip = new PizZip(arrayBuffer);\r\n        const doc = new Docxtemplater(zip);\r\n\r\n        const dataToRender = {\r\n            protocol_number: protocol_number,\r\n            group_protection_date: new Date(dateStart).toLocaleDateString('ru-RU'),\r\n            hours_start: hours_start,\r\n            min_start: min_start,\r\n            hours_end: hours_end,\r\n            min_end: min_end,\r\n            chairman_last_name: chairman.user.last_name,\r\n            chairman_np: np,\r\n            chairman_degree: chairman.employee_information.academic_degree,\r\n            chairman_job_title: chairman.employee_information.job_title,\r\n            members_list: members_list.map(member => ({\r\n                members_last_name: member.user.last_name,\r\n                members_np: getInitials(member.user.first_name, member.user.patronymic),\r\n                members_degree: member.employee_information.academic_degree || '',\r\n                members_job_title: member.employee_information.job_title,\r\n                members_place_of_work: member.employee_information.place_of_work,\r\n            })),\r\n            student_fullname: student_fullname,\r\n            specialityCode: specialityCode,\r\n            specialtityProgram: specialtityProgram,\r\n            theme: theme,\r\n            teacher_first_name: teacher_first_name,\r\n            teacher_np: teacher_np,\r\n            teacher_degree: teacher_degree,\r\n            teacher_job_title: teacher_job_title,\r\n            reviewer_first_name: reviewer_first_name,\r\n            reviewer_np: reviewer_np,\r\n            reviewer_degree: reviewer_degree,\r\n            reviewer_job_title: reviewer_job_title,\r\n            student_first_name: student_first_name,\r\n            student_np: student_np,\r\n            duration: duration,\r\n        };\r\n\r\n        doc.setData(dataToRender);\r\n        doc.render();\r\n\r\n        const output = doc.getZip().generate({ type: 'blob' });\r\n        saveAs(output, `Протокол №${protocol_number}.docx`);\r\n    } catch (error) {\r\n        console.error('Ошибка загрузки файла:', error);\r\n    }\r\n};\r\n\r\nexport default generateProtocolsFunction;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}