{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './1.docx';\nconst generateTask = async ({\n  studentData,\n  teacherData,\n  requestData\n}) => {\n  const fullname = `${studentData.last_name} ${studentData.first_name} ${studentData.patronymic}`;\n  const surname_gen = petrovich.female.last.genitive(studentData.last_name);\n  const rne = new RussianNouns.Engine();\n  const declineWord = (word, gender) => rne.decline({\n    text: word.split(' ')[0],\n    gender\n  }, 'родительный');\n  let form_of_studying = studentData.form_of_studying.replace(studentData.form_of_studying.split(' ')[0], declineWord(studentData.form_of_studying, 'женский'));\n  let academic_title = teacherData.academic_title.replace(teacherData.academic_title.split(' ')[0], declineWord(teacherData.academic_title, 'средний'));\n  let job_title = teacherData.job_title.replace(teacherData.job_title.split(' ')[0], declineWord(teacherData.job_title, 'средний'));\n  let place_of_work = teacherData.place_of_work.replace(teacherData.place_of_work.split(' ')[0], declineWord(teacherData.place_of_work, 'женский'));\n  try {\n    const response = await fetch(word);\n    if (!response.ok) throw new Error('Ошибка сети');\n    const arrayBuffer = await response.arrayBuffer();\n    const zip = new PizZip(arrayBuffer);\n    const doc = new Docxtemplater(zip);\n    const dataToRender = {\n      last_name: studentData.last_name,\n      first_name: studentData.first_name,\n      patronymic: studentData.patronymic,\n      group_name: studentData.group.name,\n      speciality_code: studentData.speciality.code,\n      speciality_name: studentData.speciality.name,\n      theme_name: requestData.theme.name,\n      np: teacherData.np,\n      first_name_teacher: teacherData.first_name,\n      job_title: job_title,\n      academic_title: academic_title,\n      place_of_work: place_of_work,\n      type_of_program: type_of_program,\n      type_of_speciality: type_of_speciality\n    };\n\n    // Установка данных и рендеринг документа\n    doc.setData(dataToRender);\n    doc.render();\n\n    // Сохранение документа\n    const output = doc.getZip().generate({\n      type: 'blob'\n    });\n    saveAs(output, 'Задание на ВКР.docx');\n  } catch (error) {\n    console.error('Ошибка загрузки файла:', error);\n  }\n};\nexport default generateTask;","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateTask","studentData","teacherData","requestData","fullname","last_name","first_name","patronymic","surname_gen","female","last","genitive","rne","Engine","declineWord","gender","decline","text","split","form_of_studying","replace","academic_title","job_title","place_of_work","response","fetch","ok","Error","arrayBuffer","zip","doc","dataToRender","group_name","group","name","speciality_code","speciality","code","speciality_name","theme_name","theme","np","first_name_teacher","type_of_program","type_of_speciality","setData","render","output","getZip","generate","type","error","console"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/хлам/react project/client/src/components/Modals/ScheduleFQWModal/GenerateTask.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './1.docx'; \r\n\r\nconst generateTask = async ({ studentData, teacherData, requestData }) => {\r\n  \r\n  const fullname = `${studentData.last_name} ${studentData.first_name} ${studentData.patronymic}`;\r\n  const surname_gen = petrovich.female.last.genitive(studentData.last_name);\r\n  \r\n  const rne = new RussianNouns.Engine();\r\n  const declineWord = (word, gender) => rne.decline({ text: word.split(' ')[0], gender }, 'родительный');\r\n  let form_of_studying = studentData.form_of_studying.replace(studentData.form_of_studying.split(' ')[0], declineWord(studentData.form_of_studying, 'женский'));\r\n  let academic_title = teacherData.academic_title.replace(teacherData.academic_title.split(' ')[0], declineWord(teacherData.academic_title, 'средний'));\r\n  let job_title = teacherData.job_title.replace(teacherData.job_title.split(' ')[0], declineWord(teacherData.job_title, 'средний'));\r\n  let place_of_work = teacherData.place_of_work.replace(teacherData.place_of_work.split(' ')[0], declineWord(teacherData.place_of_work, 'женский'));\r\n\r\n  try {\r\n\r\n    const response = await fetch(word);\r\n    if (!response.ok) throw new Error('Ошибка сети');\r\n    const arrayBuffer = await response.arrayBuffer();\r\n    const zip = new PizZip(arrayBuffer);\r\n    const doc = new Docxtemplater(zip);\r\n\r\n    const dataToRender = {\r\n      last_name: studentData.last_name,\r\n      first_name: studentData.first_name,\r\n      patronymic: studentData.patronymic,\r\n      group_name: studentData.group.name,\r\n      speciality_code: studentData.speciality.code,\r\n      speciality_name: studentData.speciality.name,\r\n      theme_name: requestData.theme.name,\r\n      np: teacherData.np,\r\n      first_name_teacher: teacherData.first_name,\r\n      job_title: job_title,\r\n      academic_title: academic_title,\r\n      place_of_work: place_of_work,\r\n      type_of_program: type_of_program,\r\n      type_of_speciality: type_of_speciality,\r\n    };\r\n\r\n    // Установка данных и рендеринг документа\r\n    doc.setData(dataToRender);\r\n    doc.render();\r\n\r\n    // Сохранение документа\r\n    const output = doc.getZip().generate({ type: 'blob' });\r\n    saveAs(output, 'Задание на ВКР.docx');\r\n  } catch (error) {\r\n    console.error('Ошибка загрузки файла:', error);\r\n  }\r\n};\r\n\r\nexport default generateTask;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}