{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './3.docx';\nconst generateTask = async ({\n  data,\n  request_data_task,\n  schedule_stud_prof\n}) => {\n  const person = {\n    first: data.user.first_name,\n    middle: data.user.patronymic,\n    last: data.user.last_name\n  };\n  const fio = petrovich(person, 'dative');\n  const rne = new RussianNouns.Engine();\n  function getInitials(firstName, patronymic) {\n    return `${firstName.charAt(0)}.${patronymic.charAt(0)}.`;\n  }\n  const np_s = getInitials(data.user.first_name, data.user.patronymic);\n  const np_t = getInitials(request_data_task.teacher.first_name, request_data_task.teacher.patronymic);\n  const year = new Date().getFullYear();\n  const declineWord = (word, gender) => rne.decline({\n    text: word.split(' ')[0],\n    gender\n  }, 'родительный');\n  let place_of_work = request_data_task.teacher.employee_information.place_of_work.replace(request_data_task.teacher.employee_information.place_of_work.split(' ')[0], declineWord(request_data_task.teacher.employee_information.place_of_work, 'женский'));\n  try {\n    const response = await fetch(word);\n    if (!response.ok) throw new Error('Ошибка сети');\n    const arrayBuffer = await response.arrayBuffer();\n    const zip = new PizZip(arrayBuffer);\n    const doc = new Docxtemplater(zip);\n    const dataToRender = {\n      year: year,\n      dat_student_last_name: fio.last,\n      student_last_name: request_data_task.student.user.last_name,\n      student_first_name: fio.first,\n      student_patronymic: fio.middle,\n      group_name: request_data_task.student.group.name,\n      speciality_code: request_data_task.student.group.speciality.code,\n      speciality_name: request_data_task.student.group.speciality.name,\n      profile_code: request_data_task.student.group.speciality.field_of_study.code,\n      profile_name: request_data_task.student.group.speciality.field_of_study.name,\n      theme_name: request_data_task.theme.name,\n      np_s: np_s,\n      np_t: np_t,\n      teacher_last_name: request_data_task.teacher.user.last_name,\n      job_title: request_data_task.teacher.employee_information.job_title,\n      place_of_work: place_of_work,\n      schedule_stud_prof: schedule_stud_prof.map(stage => ({\n        stage_name: stage.stage_name,\n        start: stage.start,\n        end: stage.end ? '-' + stage.end : '',\n        result: stage.result,\n        completion_mark: stage.completion_mark ? 'Выполнено' : 'не выполнено'\n      }))\n    };\n    doc.setData(dataToRender);\n    doc.render();\n    const output = doc.getZip().generate({\n      type: 'blob'\n    });\n    saveAs(output, `Задание на ВКР ${request_data_task.student.user.last_name}.docx`);\n  } catch (error) {\n    console.error('Ошибка загрузки файла:', error);\n  }\n};\nexport default generateTask;","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateTask","data","request_data_task","schedule_stud_prof","person","first","user","first_name","middle","patronymic","last","last_name","fio","rne","Engine","getInitials","firstName","charAt","np_s","np_t","teacher","year","Date","getFullYear","declineWord","gender","decline","text","split","place_of_work","employee_information","replace","response","fetch","ok","Error","arrayBuffer","zip","doc","dataToRender","dat_student_last_name","student_last_name","student","student_first_name","student_patronymic","group_name","group","name","speciality_code","speciality","code","speciality_name","profile_code","field_of_study","profile_name","theme_name","theme","teacher_last_name","job_title","map","stage","stage_name","start","end","result","completion_mark","setData","render","output","getZip","generate","type","error","console"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/хлам/react project/client/src/components/Modals/ScheduleFQWModal/GenerateTask.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './3.docx';\r\n\r\nconst generateTask = async ({ data, request_data_task, schedule_stud_prof }) => {\r\n  const person = {\r\n    first: data.user.first_name,\r\n    middle: data.user.patronymic,\r\n    last: data.user.last_name,\r\n  };\r\n  const fio = petrovich(person, 'dative');\r\n  const rne = new RussianNouns.Engine();\r\n\r\n  function getInitials(firstName, patronymic) {\r\n    return `${firstName.charAt(0)}.${patronymic.charAt(0)}.`;\r\n  }\r\n  const np_s = getInitials(data.user.first_name, data.user.patronymic);\r\n  const np_t = getInitials(request_data_task.teacher.first_name, request_data_task.teacher.patronymic);\r\n  const year = new Date().getFullYear();\r\n  const declineWord = (word, gender) => rne.decline({ text: word.split(' ')[0], gender }, 'родительный');\r\n  let place_of_work = request_data_task.teacher.employee_information.place_of_work.replace(\r\n    request_data_task.teacher.employee_information.place_of_work.split(' ')[0],\r\n    declineWord(request_data_task.teacher.employee_information.place_of_work, 'женский')\r\n  );\r\n\r\n  try {\r\n    const response = await fetch(word);\r\n    if (!response.ok) throw new Error('Ошибка сети');\r\n    const arrayBuffer = await response.arrayBuffer();\r\n    const zip = new PizZip(arrayBuffer);\r\n    const doc = new Docxtemplater(zip);\r\n\r\n    const dataToRender = {\r\n      year: year,\r\n      dat_student_last_name: fio.last,\r\n      student_last_name: request_data_task.student.user.last_name,\r\n      student_first_name: fio.first,\r\n      student_patronymic: fio.middle,\r\n      group_name: request_data_task.student.group.name,\r\n      speciality_code: request_data_task.student.group.speciality.code,\r\n      speciality_name: request_data_task.student.group.speciality.name,\r\n      profile_code: request_data_task.student.group.speciality.field_of_study.code,\r\n      profile_name: request_data_task.student.group.speciality.field_of_study.name,\r\n      theme_name: request_data_task.theme.name,\r\n      np_s: np_s,\r\n      np_t: np_t,\r\n      teacher_last_name: request_data_task.teacher.user.last_name,\r\n      job_title: request_data_task.teacher.employee_information.job_title,\r\n      place_of_work: place_of_work,\r\n      schedule_stud_prof: schedule_stud_prof.map(stage => ({\r\n        stage_name: stage.stage_name,\r\n        start: stage.start,\r\n        end: stage.end ? '-' + stage.end : '',\r\n        result: stage.result,\r\n        completion_mark: stage.completion_mark ? 'Выполнено' : 'не выполнено',\r\n      }))\r\n    };\r\n\r\n    doc.setData(dataToRender);\r\n    doc.render();\r\n\r\n    const output = doc.getZip().generate({ type: 'blob' });\r\n    saveAs(output, `Задание на ВКР ${request_data_task.student.user.last_name}.docx`);\r\n  } catch (error) {\r\n    console.error('Ошибка загрузки файла:', error);\r\n  }\r\n};\r\n\r\nexport default generateTask;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}