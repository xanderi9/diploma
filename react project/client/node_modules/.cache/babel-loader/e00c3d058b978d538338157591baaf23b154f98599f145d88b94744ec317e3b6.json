{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './1.docx';\nconst generateDocument = () => {\n  const xhr = new XMLHttpRequest();\n  xhr.open('GET', word, true);\n  xhr.responseType = 'arraybuffer';\n  xhr.onload = () => {\n    if (xhr.status === 200) {\n      const data = new Uint8Array(xhr.response);\n      const zip = new PizZip(data);\n      let doc;\n      try {\n        doc = new Docxtemplater(zip);\n      } catch (error) {\n        console.error('Ошибка создания документа:', error);\n        return;\n      }\n      const dataToRender = {\n        np_s: np_s,\n        np_t: np_t,\n        surname: surname_gen,\n        phoneNumber: studentData.phone_number,\n        email: studentData.email,\n        kurs: studentData.kurs,\n        group: studentData.group,\n        specialtyCode: studentData.specialtyCode,\n        specialtyName: studentData.specialtyName,\n        fieldOfStudyCode: studentData.fieldOfStudyCode,\n        fieldOfStudyName: studentData.fieldOfStudyName,\n        form_of_studying: studentData.form_of_studying,\n        base_of_studying: studentData.basis_of_study,\n        fullname: fullname,\n        theme_str: requestData.theme_str,\n        fullnameTeacher: fullnameTeac,\n        surnameTeacher: teacherData.surname,\n        academic_degree: academic_degree,\n        academic_title: academic_title,\n        job_title: teacherData.job_title,\n        place_of_work: teacherData.place_of_work\n      };\n      doc.setData(dataToRender);\n      try {\n        doc.render();\n      } catch (error) {\n        console.error('Ошибка рендеринга документа:', error);\n        return;\n      }\n      const output = doc.getZip().generate({\n        type: 'blob'\n      });\n      saveAs(output, 'generated_document.docx');\n    } else {\n      console.error('Ошибка загрузки файла:', xhr.statusText);\n    }\n  };\n  xhr.onerror = () => {\n    console.error('Ошибка загрузки файла:', xhr.statusText);\n  };\n  xhr.send();\n};\nexport default generateDocument;\nfunction extractVariables(template) {\n  var re = /({.*?})/sg;\n  let variables = [];\n  let result;\n  while ((result = re.exec(template)) !== null) {\n    variables.push(result[0]);\n  }\n  return variables;\n}","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateDocument","xhr","XMLHttpRequest","open","responseType","onload","status","data","Uint8Array","response","zip","doc","error","console","dataToRender","np_s","np_t","surname","surname_gen","phoneNumber","studentData","phone_number","email","kurs","group","specialtyCode","specialtyName","fieldOfStudyCode","fieldOfStudyName","form_of_studying","base_of_studying","basis_of_study","fullname","theme_str","requestData","fullnameTeacher","fullnameTeac","surnameTeacher","teacherData","academic_degree","academic_title","job_title","place_of_work","setData","render","output","getZip","generate","type","statusText","onerror","send","extractVariables","template","re","variables","result","exec","push"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/react project/client/src/components/Forms/GenerateApplicationForm/GenerateDocumentFunction.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './1.docx';\r\n\r\n\r\n\r\n\r\nconst generateDocument = () => {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', word, true);\r\n    xhr.responseType = 'arraybuffer';\r\n\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) {\r\n        const data = new Uint8Array(xhr.response);\r\n        const zip = new PizZip(data);\r\n        let doc;\r\n        try {\r\n          doc = new Docxtemplater(zip);\r\n        } catch (error) {\r\n          console.error('Ошибка создания документа:', error);\r\n          return;\r\n        }\r\n\r\n        const dataToRender = {\r\n          np_s: np_s,\r\n          np_t: np_t,\r\n          surname: surname_gen,\r\n          phoneNumber: studentData.phone_number,\r\n          email: studentData.email,\r\n          kurs: studentData.kurs,\r\n          group: studentData.group,\r\n          specialtyCode: studentData.specialtyCode,\r\n          specialtyName: studentData.specialtyName,\r\n          fieldOfStudyCode: studentData.fieldOfStudyCode,\r\n          fieldOfStudyName: studentData.fieldOfStudyName,\r\n          form_of_studying: studentData.form_of_studying,\r\n          base_of_studying: studentData.basis_of_study,\r\n          fullname: fullname,\r\n          theme_str: requestData.theme_str,\r\n          fullnameTeacher:fullnameTeac,\r\n          surnameTeacher: teacherData.surname,\r\n          academic_degree: academic_degree,\r\n          academic_title: academic_title,\r\n          job_title: teacherData.job_title,\r\n          place_of_work: teacherData.place_of_work,\r\n        };\r\n\r\n        doc.setData(dataToRender);\r\n\r\n        try {\r\n          doc.render();\r\n        } catch (error) {\r\n          console.error('Ошибка рендеринга документа:', error);\r\n          return;\r\n        }\r\n\r\n        const output = doc.getZip().generate({ type: 'blob' });\r\n        saveAs(output, 'generated_document.docx');\r\n      } else {\r\n        console.error('Ошибка загрузки файла:', xhr.statusText);\r\n      }\r\n    };\r\n\r\n    xhr.onerror = () => {\r\n      console.error('Ошибка загрузки файла:', xhr.statusText);\r\n    };\r\n\r\n    xhr.send();\r\n  };\r\n\r\nexport default generateDocument\r\n\r\nfunction extractVariables(template) {\r\n    var re = /({.*?})/sg;\r\n    let variables = [];\r\n    let result;\r\n    while ((result = re.exec(template)) !== null) {\r\n        variables.push(result[0]); \r\n    }\r\n    return variables;\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}