{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './2.docx';\nconst generateTask = async ({\n  request_data_task\n}) => {\n  console.log(request_data_task);\n  function getInitials(firstName, patronymic) {\n    return `${firstName.charAt(0)}.${patronymic.charAt(0)}.`;\n  }\n  const np = getInitials(request_data_task.teacher.user.first_name, request_data_task.teacher.user.patronymic);\n  try {\n    const response = await fetch(word);\n    if (!response.ok) throw new Error('Ошибка сети');\n    const arrayBuffer = await response.arrayBuffer();\n    const zip = new PizZip(arrayBuffer);\n    const doc = new Docxtemplater(zip);\n    const dataToRender = {\n      year: Date().getFullYear(),\n      date: Date().toLocaleDateString(),\n      student_last_name: request_data_task.student.user.last_name,\n      student_first_name: request_data_task.student.user.first_name,\n      student_patronymic: request_data_task.student.user.patronymic,\n      group_name: request_data_task.student.group.name,\n      speciality_code: request_data_task.student.group.speciality.code,\n      speciality_name: request_data_task.student.group.speciality.name,\n      theme_name: request_data_task.theme.name,\n      np: np,\n      teacher_last_name: request_data_task.teacher.user.first_name,\n      job_title: request_data_task.teacher.user.job_title,\n      place_of_work: request_data_task.teacher.user.place_of_work\n    };\n\n    // Установка данных и рендеринг документа\n    doc.setData(dataToRender);\n    doc.render();\n\n    // Сохранение документа\n    const output = doc.getZip().generate({\n      type: 'blob'\n    });\n    saveAs(output, 'Задание на ВКР.docx');\n  } catch (error) {\n    console.error('Ошибка загрузки файла:', error);\n  }\n};\nexport default generateTask;","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateTask","request_data_task","console","log","getInitials","firstName","patronymic","charAt","np","teacher","user","first_name","response","fetch","ok","Error","arrayBuffer","zip","doc","dataToRender","year","Date","getFullYear","date","toLocaleDateString","student_last_name","student","last_name","student_first_name","student_patronymic","group_name","group","name","speciality_code","speciality","code","speciality_name","theme_name","theme","teacher_last_name","job_title","place_of_work","setData","render","output","getZip","generate","type","error"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/хлам/react project/client/src/components/Modals/ScheduleFQWModal/GenerateTask.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './2.docx'; \r\n\r\nconst generateTask = async ({request_data_task }) => {\r\n\r\n    console.log(request_data_task)\r\n    function getInitials(firstName, patronymic) {\r\n        return `${firstName.charAt(0)}.${patronymic.charAt(0)}.`;\r\n      }\r\n      const np = getInitials(request_data_task.teacher.user.first_name, request_data_task.teacher.user.patronymic);\r\n      \r\n  \r\n  try {\r\n\r\n    const response = await fetch(word);\r\n    if (!response.ok) throw new Error('Ошибка сети');\r\n    const arrayBuffer = await response.arrayBuffer();\r\n    const zip = new PizZip(arrayBuffer);\r\n    const doc = new Docxtemplater(zip);\r\n\r\n    const dataToRender = {\r\n        year: Date().getFullYear(),\r\n        date: Date().toLocaleDateString(),\r\n      student_last_name: request_data_task.student.user.last_name,\r\n      student_first_name: request_data_task.student.user.first_name,\r\n      student_patronymic: request_data_task.student.user.patronymic,\r\n      group_name: request_data_task.student.group.name,\r\n      speciality_code: request_data_task.student.group.speciality.code,\r\n      speciality_name: request_data_task.student.group.speciality.name,\r\n      theme_name: request_data_task.theme.name,\r\n      np: np,\r\n      teacher_last_name: request_data_task.teacher.user.first_name,\r\n      job_title: request_data_task.teacher.user.job_title,\r\n      place_of_work: request_data_task.teacher.user.place_of_work,\r\n    };\r\n\r\n    // Установка данных и рендеринг документа\r\n    doc.setData(dataToRender);\r\n    doc.render();\r\n\r\n    // Сохранение документа\r\n    const output = doc.getZip().generate({ type: 'blob' });\r\n    saveAs(output, 'Задание на ВКР.docx');\r\n  } catch (error) {\r\n    console.error('Ошибка загрузки файла:', error);\r\n  }\r\n};\r\n\r\nexport default generateTask;\r\n"],"mappings":"AAAA,OAAOA,SAAS,MAAM,WAAW;AACjC,OAAOC,YAAY,MAAM,kBAAkB;AAC3C,SAASC,MAAM,QAAQ,YAAY;AACnC,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,aAAa,MAAM,eAAe;AACzC,OAAOC,IAAI,MAAM,UAAU;AAE3B,MAAMC,YAAY,GAAG,MAAAA,CAAO;EAACC;AAAkB,CAAC,KAAK;EAEjDC,OAAO,CAACC,GAAG,CAACF,iBAAiB,CAAC;EAC9B,SAASG,WAAWA,CAACC,SAAS,EAAEC,UAAU,EAAE;IACxC,OAAQ,GAAED,SAAS,CAACE,MAAM,CAAC,CAAC,CAAE,IAAGD,UAAU,CAACC,MAAM,CAAC,CAAC,CAAE,GAAE;EAC1D;EACA,MAAMC,EAAE,GAAGJ,WAAW,CAACH,iBAAiB,CAACQ,OAAO,CAACC,IAAI,CAACC,UAAU,EAAEV,iBAAiB,CAACQ,OAAO,CAACC,IAAI,CAACJ,UAAU,CAAC;EAGhH,IAAI;IAEF,MAAMM,QAAQ,GAAG,MAAMC,KAAK,CAACd,IAAI,CAAC;IAClC,IAAI,CAACa,QAAQ,CAACE,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,aAAa,CAAC;IAChD,MAAMC,WAAW,GAAG,MAAMJ,QAAQ,CAACI,WAAW,CAAC,CAAC;IAChD,MAAMC,GAAG,GAAG,IAAIpB,MAAM,CAACmB,WAAW,CAAC;IACnC,MAAME,GAAG,GAAG,IAAIpB,aAAa,CAACmB,GAAG,CAAC;IAElC,MAAME,YAAY,GAAG;MACjBC,IAAI,EAAEC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MAC1BC,IAAI,EAAEF,IAAI,CAAC,CAAC,CAACG,kBAAkB,CAAC,CAAC;MACnCC,iBAAiB,EAAExB,iBAAiB,CAACyB,OAAO,CAAChB,IAAI,CAACiB,SAAS;MAC3DC,kBAAkB,EAAE3B,iBAAiB,CAACyB,OAAO,CAAChB,IAAI,CAACC,UAAU;MAC7DkB,kBAAkB,EAAE5B,iBAAiB,CAACyB,OAAO,CAAChB,IAAI,CAACJ,UAAU;MAC7DwB,UAAU,EAAE7B,iBAAiB,CAACyB,OAAO,CAACK,KAAK,CAACC,IAAI;MAChDC,eAAe,EAAEhC,iBAAiB,CAACyB,OAAO,CAACK,KAAK,CAACG,UAAU,CAACC,IAAI;MAChEC,eAAe,EAAEnC,iBAAiB,CAACyB,OAAO,CAACK,KAAK,CAACG,UAAU,CAACF,IAAI;MAChEK,UAAU,EAAEpC,iBAAiB,CAACqC,KAAK,CAACN,IAAI;MACxCxB,EAAE,EAAEA,EAAE;MACN+B,iBAAiB,EAAEtC,iBAAiB,CAACQ,OAAO,CAACC,IAAI,CAACC,UAAU;MAC5D6B,SAAS,EAAEvC,iBAAiB,CAACQ,OAAO,CAACC,IAAI,CAAC8B,SAAS;MACnDC,aAAa,EAAExC,iBAAiB,CAACQ,OAAO,CAACC,IAAI,CAAC+B;IAChD,CAAC;;IAED;IACAvB,GAAG,CAACwB,OAAO,CAACvB,YAAY,CAAC;IACzBD,GAAG,CAACyB,MAAM,CAAC,CAAC;;IAEZ;IACA,MAAMC,MAAM,GAAG1B,GAAG,CAAC2B,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC;MAAEC,IAAI,EAAE;IAAO,CAAC,CAAC;IACtDnD,MAAM,CAACgD,MAAM,EAAE,qBAAqB,CAAC;EACvC,CAAC,CAAC,OAAOI,KAAK,EAAE;IACd9C,OAAO,CAAC8C,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;EAChD;AACF,CAAC;AAED,eAAehD,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}