{"ast":null,"code":"import React from 'react';\nimport petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nfunction extractVariables(template) {\n  var re = /({.*?})/sg;\n  let variables = [];\n  let result;\n  while ((result = re.exec(template)) !== null) {\n    variables.push(result[0]);\n  }\n  return variables;\n}\nconst np_s = studentData.name.charAt(0) + '.' + studentData.patronymic.charAt(0) + '. ';\nconst np_t = teacherData.name.charAt(0) + '.' + teacherData.patronymic.charAt(0) + '. ';\nvar surname_gen = petrovich.female.last.genitive(studentData.surname);\nvar teacher = {\n  last: teacherData.surname,\n  first: teacherData.name,\n  middle: teacherData.patronymic\n};\nvar fullnameTeac = petrovich(teacher, 'accusative');\nfullnameTeac = fullnameTeac.last + ' ' + fullnameTeac.first + ' ' + fullnameTeac.middle;\nconst rne = new RussianNouns.Engine();\nlet academic_title = teacherData.academic_title;\nlet academic_degree = teacherData.academic_degree;\nconst firstWordTitle = academic_title.split(\" \")[0];\nconst firstWordDegree = academic_degree.split(\" \")[0];\nconst declinedTitle = rne.decline({\n  text: firstWordTitle,\n  gender: 'средний'\n}, 'родительный');\nconst declinedDegree = rne.decline({\n  text: firstWordDegree,\n  gender: 'средний'\n}, 'родительный');\nacademic_title = academic_title.replace(firstWordTitle, declinedTitle);\nacademic_degree = academic_degree.replace(firstWordDegree, declinedDegree);\nfunction GenerateDocumentFunction({\n  word,\n  studentData,\n  teacherData,\n  context\n}) {\n  const xhr = new XMLHttpRequest();\n  xhr.open('GET', word, true);\n  xhr.responseType = 'arraybuffer';\n  xhr.onload = () => {\n    if (xhr.status === 200) {\n      const data = new Uint8Array(xhr.response);\n      const zip = new PizZip(data);\n      let doc;\n      try {\n        doc = new Docxtemplater(zip);\n      } catch (error) {\n        console.error('Ошибка создания документа:', error);\n        return;\n      }\n      const dataToRender = {\n        np_s: np_s,\n        np_t: np_t,\n        surname: surname_gen,\n        phoneNumber: studentData.phone_number,\n        email: studentData.email,\n        kurs: studentData.kurs,\n        group: studentData.group,\n        specialtyCode: studentData.specialtyCode,\n        specialtyName: studentData.specialtyName,\n        fieldOfStudyCode: studentData.fieldOfStudyCode,\n        fieldOfStudyName: studentData.fieldOfStudyName,\n        form_of_studying: studentData.form_of_studying,\n        base_of_studying: studentData.basis_of_study,\n        fullname: fullname,\n        theme_str: requestData.theme_str,\n        fullnameTeacher: fullnameTeac,\n        surnameTeacher: teacherData.surname,\n        academic_degree: academic_degree,\n        academic_title: academic_title,\n        job_title: teacherData.job_title,\n        place_of_work: teacherData.place_of_work\n      };\n      doc.setData(dataToRender);\n      try {\n        doc.render();\n      } catch (error) {\n        console.error('Ошибка рендеринга документа:', error);\n        return;\n      }\n      const output = doc.getZip().generate({\n        type: 'blob'\n      });\n      saveAs(output, 'generated_document.docx');\n    } else {\n      console.error('Ошибка загрузки файла:', xhr.statusText);\n    }\n  };\n  xhr.onerror = () => {\n    console.error('Ошибка загрузки файла:', xhr.statusText);\n  };\n  xhr.send();\n}\n_c = GenerateDocumentFunction;\nexport default GenerateDocumentFunction;\nvar _c;\n$RefreshReg$(_c, \"GenerateDocumentFunction\");","map":{"version":3,"names":["React","petrovich","RussianNouns","extractVariables","template","re","variables","result","exec","push","np_s","studentData","name","charAt","patronymic","np_t","teacherData","surname_gen","female","last","genitive","surname","teacher","first","middle","fullnameTeac","rne","Engine","academic_title","academic_degree","firstWordTitle","split","firstWordDegree","declinedTitle","decline","text","gender","declinedDegree","replace","GenerateDocumentFunction","word","context","xhr","XMLHttpRequest","open","responseType","onload","status","data","Uint8Array","response","zip","PizZip","doc","Docxtemplater","error","console","dataToRender","phoneNumber","phone_number","email","kurs","group","specialtyCode","specialtyName","fieldOfStudyCode","fieldOfStudyName","form_of_studying","base_of_studying","basis_of_study","fullname","theme_str","requestData","fullnameTeacher","surnameTeacher","job_title","place_of_work","setData","render","output","getZip","generate","type","saveAs","statusText","onerror","send","_c","$RefreshReg$"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/react project/client/src/components/Forms/GenerateApplicationForm/GenerateDocumentFunction.js"],"sourcesContent":["\r\nimport React from 'react'\r\nimport petrovich from 'petrovich'\r\nimport RussianNouns from 'russian-nouns-js'\r\n\r\nfunction extractVariables(template) {\r\n    var re = /({.*?})/sg;\r\n    let variables = [];\r\n    let result;\r\n    while ((result = re.exec(template)) !== null) {\r\n        variables.push(result[0]); \r\n    }\r\n    return variables;\r\n}\r\n\r\nconst np_s = studentData.name.charAt(0) + '.'+ studentData.patronymic.charAt(0) + '. ';\r\n    const np_t = teacherData.name.charAt(0) + '.' + teacherData.patronymic.charAt(0) + '. ';\r\n    var surname_gen = petrovich.female.last.genitive (studentData.surname);\r\n    \r\n    var teacher = {\r\n      last: teacherData.surname,\r\n      first: teacherData.name,\r\n      middle: teacherData.patronymic\r\n     };\r\n\r\n     var fullnameTeac = petrovich(teacher, 'accusative');\r\n     fullnameTeac = fullnameTeac.last + ' ' + fullnameTeac.first + ' '+ fullnameTeac.middle\r\n\r\n     const rne = new RussianNouns.Engine();\r\n    \r\n     let academic_title = teacherData.academic_title;\r\n     let academic_degree = teacherData.academic_degree;\r\n     const firstWordTitle = academic_title.split(\" \")[0];\r\n     const firstWordDegree = academic_degree.split(\" \")[0];\r\n     const declinedTitle = rne.decline({text: firstWordTitle, gender: 'средний'}, 'родительный');\r\n     const declinedDegree = rne.decline({text: firstWordDegree, gender: 'средний'}, 'родительный');\r\n     academic_title = academic_title.replace(firstWordTitle, declinedTitle);\r\n     academic_degree = academic_degree.replace(firstWordDegree, declinedDegree);\r\n\r\n\r\n\r\nfunction GenerateDocumentFunction({word, studentData, teacherData, context }) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', word, true);\r\n    xhr.responseType = 'arraybuffer';\r\n\r\n    xhr.onload = () => {\r\n        if (xhr.status === 200) {\r\n            const data = new Uint8Array(xhr.response);\r\n            const zip = new PizZip(data);\r\n            let doc;\r\n            try {\r\n                doc = new Docxtemplater(zip);\r\n            } catch (error) {\r\n                console.error('Ошибка создания документа:', error);\r\n                return;\r\n            }\r\n\r\n            const dataToRender = {\r\n                np_s: np_s,\r\n                np_t: np_t,\r\n                surname: surname_gen,\r\n                phoneNumber: studentData.phone_number,\r\n                email: studentData.email,\r\n                kurs: studentData.kurs,\r\n                group: studentData.group,\r\n                specialtyCode: studentData.specialtyCode,\r\n                specialtyName: studentData.specialtyName,\r\n                fieldOfStudyCode: studentData.fieldOfStudyCode,\r\n                fieldOfStudyName: studentData.fieldOfStudyName,\r\n                form_of_studying: studentData.form_of_studying,\r\n                base_of_studying: studentData.basis_of_study,\r\n                fullname: fullname,\r\n                theme_str: requestData.theme_str,\r\n                fullnameTeacher:fullnameTeac,\r\n                surnameTeacher: teacherData.surname,\r\n                academic_degree: academic_degree,\r\n                academic_title: academic_title,\r\n                job_title: teacherData.job_title,\r\n                place_of_work: teacherData.place_of_work,\r\n              };\r\n\r\n            doc.setData(dataToRender);\r\n\r\n            try {\r\n                doc.render();\r\n            } catch (error) {\r\n                console.error('Ошибка рендеринга документа:', error);\r\n                return;\r\n            }\r\n\r\n            const output = doc.getZip().generate({ type: 'blob' });\r\n            saveAs(output, 'generated_document.docx');\r\n        } else {\r\n            console.error('Ошибка загрузки файла:', xhr.statusText);\r\n        }\r\n    };\r\n\r\n    xhr.onerror = () => {\r\n        console.error('Ошибка загрузки файла:', xhr.statusText);\r\n    };\r\n\r\n    xhr.send();\r\n}\r\n\r\nexport default GenerateDocumentFunction"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}