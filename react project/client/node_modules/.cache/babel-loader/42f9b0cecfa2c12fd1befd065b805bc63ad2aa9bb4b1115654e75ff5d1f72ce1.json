{"ast":null,"code":"import petrovich from 'petrovich';\nimport RussianNouns from 'russian-nouns-js';\nimport { saveAs } from 'file-saver';\nimport PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\nimport word from './1.docx';\nconst generateDocument = async ({\n  studentData,\n  teacherData,\n  requestData,\n  action\n}) => {\n  // Определение действия\n  if (action === 'approve') action = 'утвердить';\n  if (action === 'change') action = 'изменить';\n\n  // Определение типа программы и специальности\n  let type_of_program, type_of_speciality;\n  if (studentData.level_of_education === 'бакалавриат') {\n    type_of_program = 'профилю / специализации';\n    type_of_speciality = 'подготовки / специальности';\n  } else if (studentData.level_of_education === 'магистратура') {\n    type_of_program = 'магистерской программе';\n    type_of_speciality = 'подготовки';\n  }\n\n  // Формирование полных имен\n  const fullname = `${studentData.surname} ${studentData.name} ${studentData.patronymic}`;\n  const np_s = `${studentData.name.charAt(0)}.${studentData.patronymic.charAt(0)}. `;\n  const np_t = `${teacherData.name.charAt(0)}.${teacherData.patronymic.charAt(0)}. `;\n\n  // Склонение фамилии студента\n  const surname_gen = petrovich.female.last.genitive(studentData.surname);\n  const teacher = {\n    last: teacherData.surname,\n    first: teacherData.name,\n    middle: teacherData.patronymic\n  };\n  let fullnameTeac = petrovich(teacher, 'accusative');\n  fullnameTeac = `${fullnameTeac.last} ${fullnameTeac.first} ${fullnameTeac.middle}`;\n  const rne = new RussianNouns.Engine();\n\n  // Склонение различных атрибутов\n  const declineWord = (word, gender) => rne.decline({\n    text: word.split(' ')[0],\n    gender\n  }, 'родительный');\n  let form_of_studying = studentData.form_of_studying.replace(studentData.form_of_studying.split(' ')[0], declineWord(studentData.form_of_studying, 'женский'));\n  let academic_title = teacherData.academic_title.replace(teacherData.academic_title.split(' ')[0], declineWord(teacherData.academic_title, 'средний'));\n  let academic_degree = teacherData.academic_degree.replace(teacherData.academic_degree.split(' ')[0], declineWord(teacherData.academic_degree, 'средний'));\n  let job_title = teacherData.job_title.replace(teacherData.job_title.split(' ')[0], declineWord(teacherData.job_title, 'средний'));\n  let place_of_work = teacherData.place_of_work.replace(teacherData.place_of_work.split(' ')[0], declineWord(teacherData.place_of_work, 'женский'));\n  try {\n    // Загрузка шаблона документа\n    const response = await fetch(word);\n    if (!response.ok) throw new Error('Ошибка сети');\n    const arrayBuffer = await response.arrayBuffer();\n    const zip = new PizZip(arrayBuffer);\n    const doc = new Docxtemplater(zip);\n\n    // Данные для рендеринга\n    const dataToRender = {\n      action,\n      type_of_program,\n      type_of_speciality,\n      np_s,\n      np_t,\n      surname: studentData.surname,\n      surname_gen,\n      phoneNumber: studentData.phone_number,\n      email: studentData.email,\n      kurs: studentData.kurs,\n      group: studentData.group,\n      specialtyCode: studentData.specialtyCode,\n      specialtyName: studentData.specialtyName,\n      fieldOfStudyCode: studentData.fieldOfStudyCode,\n      fieldOfStudyName: studentData.fieldOfStudyName,\n      form_of_studying,\n      base_of_studying: studentData.basis_of_study,\n      fullname,\n      theme_str: requestData.theme_str,\n      fullnameTeacher: fullnameTeac,\n      surnameTeacher: teacherData.surname,\n      academic_degree,\n      academic_title,\n      job_title,\n      place_of_work\n    };\n\n    // Установка данных и рендеринг документа\n    doc.setData(dataToRender);\n    try {\n      doc.render();\n    } catch (error) {\n      console.error('Ошибка рендеринга документа:', error);\n      return;\n    }\n\n    // Сохранение документа\n    const output = doc.getZip().generate({\n      type: 'blob'\n    });\n    saveAs(output, 'Заявление.docx');\n  } catch (error) {\n    console.error('Ошибка загрузки файла:', error);\n  }\n};\nexport default generateDocument;\nfunction extractVariables(template) {\n  const re = /({.*?})/sg;\n  const variables = [];\n  let result;\n  while ((result = re.exec(template)) !== null) {\n    variables.push(result[0]);\n  }\n  return variables;\n}","map":{"version":3,"names":["petrovich","RussianNouns","saveAs","PizZip","Docxtemplater","word","generateDocument","studentData","teacherData","requestData","action","type_of_program","type_of_speciality","level_of_education","fullname","surname","name","patronymic","np_s","charAt","np_t","surname_gen","female","last","genitive","teacher","first","middle","fullnameTeac","rne","Engine","declineWord","gender","decline","text","split","form_of_studying","replace","academic_title","academic_degree","job_title","place_of_work","response","fetch","ok","Error","arrayBuffer","zip","doc","dataToRender","phoneNumber","phone_number","email","kurs","group","specialtyCode","specialtyName","fieldOfStudyCode","fieldOfStudyName","base_of_studying","basis_of_study","theme_str","fullnameTeacher","surnameTeacher","setData","render","error","console","output","getZip","generate","type","extractVariables","template","re","variables","result","exec","push"],"sources":["C:/Users/79131/OneDrive/Рабочий стол/хлам/react project/client/src/components/Forms/GenerateApplicationForm/GenerateDocumentFunction.js"],"sourcesContent":["import petrovich from 'petrovich';\r\nimport RussianNouns from 'russian-nouns-js';\r\nimport { saveAs } from 'file-saver';\r\nimport PizZip from 'pizzip';\r\nimport Docxtemplater from 'docxtemplater';\r\nimport word from './1.docx';\r\n\r\nconst generateDocument = async ({ studentData, teacherData, requestData, action }) => {\r\n  // Определение действия\r\n  if (action === 'approve') action = 'утвердить';\r\n  if (action === 'change') action = 'изменить';\r\n\r\n  // Определение типа программы и специальности\r\n  let type_of_program, type_of_speciality;\r\n  if (studentData.level_of_education === 'бакалавриат') {\r\n    type_of_program = 'профилю / специализации';\r\n    type_of_speciality = 'подготовки / специальности';\r\n  } else if (studentData.level_of_education === 'магистратура') {\r\n    type_of_program = 'магистерской программе';\r\n    type_of_speciality = 'подготовки';\r\n  }\r\n\r\n  // Формирование полных имен\r\n  const fullname = `${studentData.surname} ${studentData.name} ${studentData.patronymic}`;\r\n  const np_s = `${studentData.name.charAt(0)}.${studentData.patronymic.charAt(0)}. `;\r\n  const np_t = `${teacherData.name.charAt(0)}.${teacherData.patronymic.charAt(0)}. `;\r\n\r\n  // Склонение фамилии студента\r\n  const surname_gen = petrovich.female.last.genitive(studentData.surname);\r\n  const teacher = {\r\n    last: teacherData.surname,\r\n    first: teacherData.name,\r\n    middle: teacherData.patronymic,\r\n  };\r\n\r\n  let fullnameTeac = petrovich(teacher, 'accusative');\r\n  fullnameTeac = `${fullnameTeac.last} ${fullnameTeac.first} ${fullnameTeac.middle}`;\r\n\r\n  const rne = new RussianNouns.Engine();\r\n\r\n  // Склонение различных атрибутов\r\n  const declineWord = (word, gender) => rne.decline({ text: word.split(' ')[0], gender }, 'родительный');\r\n  let form_of_studying = studentData.form_of_studying.replace(studentData.form_of_studying.split(' ')[0], declineWord(studentData.form_of_studying, 'женский'));\r\n  let academic_title = teacherData.academic_title.replace(teacherData.academic_title.split(' ')[0], declineWord(teacherData.academic_title, 'средний'));\r\n  let academic_degree = teacherData.academic_degree.replace(teacherData.academic_degree.split(' ')[0], declineWord(teacherData.academic_degree, 'средний'));\r\n  let job_title = teacherData.job_title.replace(teacherData.job_title.split(' ')[0], declineWord(teacherData.job_title, 'средний'));\r\n  let place_of_work = teacherData.place_of_work.replace(teacherData.place_of_work.split(' ')[0], declineWord(teacherData.place_of_work, 'женский'));\r\n\r\n  try {\r\n    // Загрузка шаблона документа\r\n    const response = await fetch(word);\r\n    if (!response.ok) throw new Error('Ошибка сети');\r\n    const arrayBuffer = await response.arrayBuffer();\r\n    const zip = new PizZip(arrayBuffer);\r\n    const doc = new Docxtemplater(zip);\r\n\r\n    // Данные для рендеринга\r\n    const dataToRender = {\r\n      action,\r\n      type_of_program,\r\n      type_of_speciality,\r\n      np_s,\r\n      np_t,\r\n      surname: studentData.surname,\r\n      surname_gen,\r\n      phoneNumber: studentData.phone_number,\r\n      email: studentData.email,\r\n      kurs: studentData.kurs,\r\n      group: studentData.group,\r\n      specialtyCode: studentData.specialtyCode,\r\n      specialtyName: studentData.specialtyName,\r\n      fieldOfStudyCode: studentData.fieldOfStudyCode,\r\n      fieldOfStudyName: studentData.fieldOfStudyName,\r\n      form_of_studying,\r\n      base_of_studying: studentData.basis_of_study,\r\n      fullname,\r\n      theme_str: requestData.theme_str,\r\n      fullnameTeacher: fullnameTeac,\r\n      surnameTeacher: teacherData.surname,\r\n      academic_degree,\r\n      academic_title,\r\n      job_title,\r\n      place_of_work,\r\n    };\r\n\r\n    // Установка данных и рендеринг документа\r\n    doc.setData(dataToRender);\r\n    try {\r\n      doc.render();\r\n    } catch (error) {\r\n      console.error('Ошибка рендеринга документа:', error);\r\n      return;\r\n    }\r\n\r\n    // Сохранение документа\r\n    const output = doc.getZip().generate({ type: 'blob' });\r\n    saveAs(output, 'Заявление.docx');\r\n  } catch (error) {\r\n    console.error('Ошибка загрузки файла:', error);\r\n  }\r\n};\r\n\r\nexport default generateDocument;\r\n\r\nfunction extractVariables(template) {\r\n  const re = /({.*?})/sg;\r\n  const variables = [];\r\n  let result;\r\n  while ((result = re.exec(template)) !== null) {\r\n    variables.push(result[0]);\r\n  }\r\n  return variables;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}